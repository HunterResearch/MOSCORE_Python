function [curr_rate,GradI,Grads]=MCI3d(aI,alphs,Iobj,Isig,Lobjs,Lsigs)
 
a1=alphs(1);
a2=alphs(2);
a3=alphs(3);
i1=Iobj(1);
i2=Iobj(2);
i3=Iobj(3);
l1=Lobjs(1);
l2=Lobjs(2);
l3=Lobjs(3);
covi11=Isig(1,1);
covi12=Isig(1,2);
covi22=Isig(2,2);
covi13=Isig(1,3);
covi23=Isig(2,3);
covi33=Isig(3,3);
Var1=Lsigs(1);
Var2=Lsigs(2);
Var3=Lsigs(3);
 
cond111_1=a1*aI*(a2*a3*covi23^2*(l1-i1)+a2*a3*covi13*covi23*(i2-l2)...
  +a2*a3*covi12*covi23*(i3-l3)+a3*covi13*(l3-i3) ...
  *(a2*covi22+aI*Var2)+a2*covi12*(l2-i2)*(a3*covi33+aI*Var3) ...
  +(i1-l1)*(a2*covi22+aI*Var2)*(a3*covi33+aI*Var3))*((-1)* ...
  a1*a3*(a2*(covi13^2*covi22+(-2)*covi12*covi13*covi23+covi11* ...
  covi23^2+covi12^2*covi33+(-1)*covi11*covi22*covi33)+aI*( ...
  covi13^2+(-1)*covi11*covi33)*Var2)+a1*aI*((-1)*a2*covi12^2+a2* ...
  covi11*covi22+aI*covi11*Var2)*Var3+aI*Var1*(aI*Var2*(a3*covi33+ ...
  aI*Var3)+a2*((-1)*a3*covi23^2+a3*covi22*covi33+aI*covi22*Var3)) ...
  )^(-1);
cond111_2=a2*aI*(a1*a3*covi13*covi23*(i1-l1)+a1*a3*covi13^2*(l2-i2)...
  +a1*a3*covi12*covi13*(i3-l3)+a3*covi23*(l3-i3) ...
  *(a1*covi11+aI*Var1)+a1*covi12*(l1-i1)*(a3*covi33+aI*Var3) ...
  +(i2-l2)*(a1*covi11+aI*Var1)*(a3*covi33+aI*Var3))*((-1)* ...
  a1*a3*(a2*(covi13^2*covi22+(-2)*covi12*covi13*covi23+covi11* ...
  covi23^2+covi12^2*covi33+(-1)*covi11*covi22*covi33)+aI*( ...
  covi13^2+(-1)*covi11*covi33)*Var2)+a1*aI*((-1)*a2*covi12^2+a2* ...
  covi11*covi22+aI*covi11*Var2)*Var3+aI*Var1*(aI*Var2*(a3*covi33+ ...
  aI*Var3)+a2*((-1)*a3*covi23^2+a3*covi22*covi33+aI*covi22*Var3)) ...
  )^(-1);
cond111_3=a3*aI*(a1*a2*covi12*covi23*(i1-l1)+a1*a2*covi12*covi13*( ...
  i2-l2)+a1*a2*covi12^2*(l3-i3)+a2*covi23*(l2-i2) ...
  *(a1*covi11+aI*Var1)+a1*covi13*(l1-i1)*(a2*covi22+aI*Var2) ...
  +(i3-l3)*(a1*covi11+aI*Var1)*(a2*covi22+aI*Var2))*((-1)* ...
  a1*a3*(a2*(covi13^2*covi22+(-2)*covi12*covi13*covi23+covi11* ...
  covi23^2+covi12^2*covi33+(-1)*covi11*covi22*covi33)+aI*( ...
  covi13^2+(-1)*covi11*covi33)*Var2)+a1*aI*((-1)*a2*covi12^2+a2* ...
  covi11*covi22+aI*covi11*Var2)*Var3+aI*Var1*(aI*Var2*(a3*covi33+ ...
  aI*Var3)+a2*((-1)*a3*covi23^2+a3*covi22*covi33+aI*covi22*Var3)) ...
  )^(-1);
cond110_1=a1*aI*(a2*(covi22*(i1-l1)+covi12*(l2-i2))+...
  aI*(i1-l1)*Var2)*(aI*Var1*(a2*covi22+aI*Var2)+a1*((-1)*a2*covi12^2+ ...
  a2*covi11*covi22+aI*covi11*Var2))^(-1);
cond110_2=a2*aI*(a1*(covi12*(l1-i1)+covi11*(i2-l2))+ ...
  aI*(i2-l2)*Var1)*(aI*Var1*(a2*covi22+aI*Var2)+a1*((-1)*a2*covi12^2+ ...
  a2*covi11*covi22+aI*covi11*Var2))^(-1);
cond110_3=l3+(-1)*(a1*a2*((-1)*covi12^2*i3+covi12*covi23*(i1-l1)+ ...
  covi13*(covi22*(l1-i1)+covi12*(i2-l2))+covi11*((-1)* ...
  covi23*i2+covi22*i3+covi23*l2))+a2*aI*(covi22*i3+ ...
  covi23*(l2-i2))*Var1+aI*(a1*(covi11*i3+covi13*(l1-i1))+aI*i3*Var1) ...
  *Var2)*(aI*Var1*(a2*covi22+aI*Var2)+a1*((-1)*a2*covi12^2+a2* ...
  covi11*covi22+aI*covi11*Var2))^(-1);
cond101_1=a1*aI*(a3*(covi33*(i1-l1)+covi13*(l3-i3))+ ...
  aI*(i1-l1)*Var3)*(aI*Var1*(a3*covi33+aI*Var3)+a1*((-1)*a3*covi13^2+ ...
  a3*covi11*covi33+aI*covi11*Var3))^(-1);
cond101_2=l2+(-1)*(a1*a3*((-1)*covi13^2*i2+covi12*covi33*(l1-i1)+ ...
  covi13*(covi23*(i1-l1)+covi12*(i3-l3))+covi11*(covi33* ...
  i2+(-1)*covi23*i3+covi23*l3))+a3*aI*(covi33*i2+ ...
  covi23*(l3-i3))*Var1+aI*(a1*(covi11*i2+covi12*(l1-i1))+aI*i2*Var1)* ...
  Var3)*(aI*Var1*(a3*covi33+aI*Var3)+a1*((-1)*a3*covi13^2+a3* ...
  covi11*covi33+aI*covi11*Var3))^(-1);
cond101_3=a3*aI*(a1*(covi13*(l1-i1)+covi11*(i3-l3))+ ...
  aI*(i3-l3)*Var1)*(aI*Var1*(a3*covi33+aI*Var3)+a1*((-1)*a3*covi13^2+ ...
  a3*covi11*covi33+aI*covi11*Var3))^(-1);
cond100_1=a1*aI*(i1-l1)*(a1*covi11+aI*Var1)^(-1);
cond100_2=-i2+l2+a1*covi12*(i1-l1)*(a1*covi11+aI*Var1)^(-1);
cond100_3=-i3+l3+a1*covi13*(i1-l1)*(a1*covi11+aI*Var1)^(-1);
cond011_1=l1+(-1)*(a2*a3*((-1)*covi23^2*i1+covi12*covi33*(l2-i2)+ ...
  covi23*(covi13*(i2-l2)+covi12*(i3-l3))+covi22*(covi33* ...
  i1+(-1)*covi13*i3+covi13*l3))+a3*aI*(covi33*i1+ ...
  covi13*(l3-i3))*Var2+aI*(a2*(covi22*i1+covi12*(l2-i2))+aI*i1*Var2)* ...
  Var3)*(aI*Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3*covi23^2+a3* ...
  covi22*covi33+aI*covi22*Var3))^(-1);
cond011_2=a2*aI*(a3*(covi33*(i2-l2)+covi23*(l3-i3))+ ...
  aI*(i2-l2)*Var3)*(aI*Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3*covi23^2+ ...
  a3*covi22*covi33+aI*covi22*Var3))^(-1);
cond011_3=a3*aI*(a2*(covi23*(l2-i2)+covi22*(i3-l3))+ ...
  aI*(i3-l3)*Var2)*(aI*Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3*covi23^2+ ...
  a3*covi22*covi33+aI*covi22*Var3))^(-1);
cond010_1=-i1+l1+a2*covi12*(i2-l2)*(a2*covi22+aI*Var2)^(-1);
cond010_2=a2*aI*(i2-l2)*(a2*covi22+aI*Var2)^(-1);
cond010_3=-i3+l3+a2*covi23*(i2-l2)*(a2*covi22+aI*Var2)^(-1);
cond001_1=-i1+l1+a3*covi13*(i3-l3)*(a3*covi33+aI*Var3)^(-1);
cond001_2=-i2+l2+a3*covi23*(i3-l3)*(a3*covi33+aI*Var3)^(-1);
cond001_3=a3*aI*(i3-l3)*(a3*covi33+aI*Var3)^(-1);
 
if (0 < cond111_1 && 0 < cond111_2 && 0 < cond111_3 ) 
   curr_rate=aI*(2*a1*(a2*a3*(covi13^2*covi22+(-2)*covi12*covi13*covi23+ ...
  covi11*covi23^2+covi12^2*covi33+(-1)*covi11*covi22*covi33)+a2* ...
  aI*(covi12^2+(-1)*covi11*covi22)*Var3+(-1)*aI*Var2*((-1)*a3* ...
  covi13^2+a3*covi11*covi33+aI*covi11*Var3))+(-2)*aI*Var1*(aI* ...
  Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3*covi23^2+a3*covi22*covi33+ ...
  aI*covi22*Var3)))^(-1)*(2*a1*a2*a3*covi12*covi13*(i2-l2) ...
  *(l3-i3)+2*a2*a3*covi23*(i2-l2)*(i3-l3)*(a1* ...
  covi11+aI*Var1)+2*a1*a3*(l1-i1)*(a2*covi12*covi33*(l2-i2)...
  +(-1)*covi13*(i3-l3)*(a2*covi22+aI*Var2))+(-1)*a3*( ...
  i3-l3)^2*(aI*Var1*(a2*covi22+aI*Var2)+a1*((-1)*a2* ...
  covi12^2+a2*covi11*covi22+aI*covi11*Var2))+2*a1*a2*(i1-l1) ...
  *(a3*covi23*(covi13*(l2-i2)+covi12*(l3-i3))+aI* ...
  covi12*(i2-l2)*Var3)+(-1)*a1*(i1-l1)^2*(aI*Var2*( ...
  a3*covi33+aI*Var3)+a2*((-1)*a3*covi23^2+a3*covi22*covi33+aI* ...
  covi22*Var3))+(i2-l2)^2*(a1*a2*a3*(covi13^2+(-1)*covi11* ...
  covi33)+(-1)*a2*aI*(a3*covi33*Var1+a1*covi11*Var3+aI*Var1*Var3) ...
  ));
   GradI=(1/2)*((-1)*a1*a3*(a2*(covi13^2*covi22+(-2)*covi12*covi13* ...
  covi23+covi11*covi23^2+covi12^2*covi33+(-1)*covi11*covi22*covi33) ...
  +aI*(covi13^2+(-1)*covi11*covi33)*Var2)+a1*aI*((-1)*a2* ...
  covi12^2+a2*covi11*covi22+aI*covi11*Var2)*Var3+aI*Var1*(aI* ...
  Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3*covi23^2+a3*covi22*covi33+ ...
  aI*covi22*Var3)))^(-2)*(aI^2*Var1^2*(a3^2*aI^2*covi33*(i3-l3)^2*Var2^2 ...
  +(-2)*a2*a3*aI*(i3-l3)*Var2*(a3*( ...
  covi23^2+(-1)*covi22*covi33)*(i3-l3)+aI*covi23*(l2-i2) ...
  *Var3)+a2^2*(a3^2*(covi23^2+(-1)*covi22*covi33)*((-1)*covi33* ...
  (i2-l2)^2+(i3-l3)*(2*covi23*i2+(-1)*covi22*i3+(-2)* ...
  covi23*l2+covi22*l3))+(-2)*a3*aI*(covi23^2+(-1)*covi22*covi33)* ...
  (i2-l2)^2*Var3+aI^2*covi22*(i2-l2)^2*Var3^2))+(-2)* ...
  a1*aI*Var1*(a3*aI^2*(i3-l3)*Var2^2*(a3*(covi13^2+(-1)* ...
  covi11*covi33)*(i3-l3)+aI*covi13*(l1-i1)*Var3)+a2*aI* ...
  Var2*(a3^2*(covi13*(covi23*(covi33*(i1-l1)*(i2-l2)+( ...
  -3)*covi12*(i3-l3)^2)+(-1)*covi23^2*(i1-l1)*(i3-l3)...
  +covi12*covi33*(i2-l2)*(i3-l3))+covi13^2*(covi23* ...
  (l2-i2)+2*covi22*(i3-l3))*(i3-l3)+covi12^2* ...
  covi33*(i3-l3)^2+2*covi11*(covi23^2+(-1)*covi22*covi33)*( ...
  i3-l3)^2+(-1)*covi12*covi33*(i1-l1)*(covi33*i2+(-1)* ...
  covi23*i3+(-1)*covi33*l2+covi23*l3))+2*a3*aI*(covi13*(covi23*( ...
  i1-l1)*(i2-l2)+(-1)*(covi22*i1+(-1)*covi12*i2+(-1)* ...
  covi22*l1+covi12*l2)*(i3-l3))+(-1)*covi11*covi23*(i2-l2)*(i3-l3)...
  +(-1)*covi12*(i1-l1)*(covi33*i2+(-1)* ...
  covi23*i3+(-1)*covi33*l2+covi23*l3))*Var3+(-1)*aI^2*covi12*(i1-l1)*(i2-l2)*Var3^2)...
  +a2^2*(a3^2*(covi13^2*covi22+( ...
  -2)*covi12*covi13*covi23+covi12^2*covi33+covi11*(covi23^2+(-1)* ...
  covi22*covi33))*(covi33*(i2-l2)^2+(2*covi23*(l2-i2)+ ...
  covi22*(i3-l3))*(i3-l3))+a3*aI*(covi13^2*covi22*(i2+( ...
  -1)*l2)^2+2*covi11*(covi23^2+(-1)*covi22*covi33)*(i2-l2) ...
  ^2+(-1)*covi12*covi23*(i1-l1)*(covi23*i2+(-1)*covi22*i3+( ...
  -1)*covi23*l2+covi22*l3)+covi12^2*(i2-l2)*(2*covi33*i2+( ...
  -1)*covi23*i3+(-2)*covi33*l2+covi23*l3)+covi13*((-3)*covi12* ...
  covi23*(i2-l2)^2+(-1)*covi22^2*(i1-l1)*(i3-l3)+ ...
  covi22*(i2-l2)*(covi23*i1+covi12*i3+(-1)*covi23*l1+(-1)* ...
  covi12*l3)))*Var3+aI^2*(covi12^2+(-1)*covi11*covi22)*(i2-l2)^2*Var3^2))...
  +a1^2*(aI^2*Var2^2*(a3^2*(covi13^2+(-1)* ...
  covi11*covi33)*((-1)*covi33*(i1-l1)^2+(i3-l3)*(2* ...
  covi13*i1+(-1)*covi11*i3+(-2)*covi13*l1+covi11*l3))+(-2)*a3*aI* ...
  (covi13^2+(-1)*covi11*covi33)*(i1-l1)^2*Var3+aI^2*covi11* ...
  (i1-l1)^2*Var3^2)+2*a2*aI*Var2*(a3^2*(covi13^2*covi22+( ...
  -2)*covi12*covi13*covi23+covi12^2*covi33+covi11*(covi23^2+(-1)* ...
  covi22*covi33))*((-1)*covi33*(i1-l1)^2+(i3-l3)*(2* ...
  covi13*(i1-l1)+covi11*(l3-i3)))+(-1)*a3*aI*(2* ...
  covi12^2*covi33*(i1-l1)^2+covi13^2*(i1-l1)*(2* ...
  covi22*(i1-l1)+covi12*(l2-i2))+covi11*(i1-l1)*( ...
  covi23^2*(i1-l1)+2*covi22*covi33*(l1-i1)+covi12* ...
  covi23*(i3-l3))+covi13*(covi11*covi23*(i1-l1)*(i2-l2)...
  +covi12*((-3)*covi23*(i1-l1)^2+covi11*(i2-l2)*( ...
  i3-l3))+(-1)*covi12^2*(i1-l1)*(i3-l3))+(-1)* ...
  covi11^2*covi23*(i2-l2)*(i3-l3))*Var3+(-1)*aI^2*( ...
  covi12^2+(-1)*covi11*covi22)*(i1-l1)^2*Var3^2)+a2^2*( ...
  a3^2*(covi13^2*covi22+(-2)*covi12*covi13*covi23+covi12^2* ...
  covi33+covi11*(covi23^2+(-1)*covi22*covi33))*(2*covi12*covi33* ...
  i1*i2+covi13^2*i2^2+(-1)*covi11*covi33*i2^2+(-2)*covi12* ...
  covi13*i2*i3+covi12^2*i3^2+covi23^2*(i1-l1)^2+(-2)* ...
  covi12*covi33*i2*l1+(-2)*covi12*covi33*i1*l2+(-2)*covi13^2* ...
  i2*l2+2*covi11*covi33*i2*l2+2*covi12*covi13*i3*l2+2*covi12* ...
  covi33*l1*l2+covi13^2*l2^2+(-1)*covi11*covi33*l2^2+2*covi23*( ...
  (-1)*covi13*(i1-l1)*(i2-l2)+(-1)*(covi12*i1+(-1)* ...
  covi11*i2+(-1)*covi12*l1+covi11*l2)*(i3-l3))+(-2)*covi12*( ...
  covi12*i3+covi13*(l2-i2))*l3+covi12^2*l3^2+(-1)*covi22*( ...
  covi33*(i1-l1)^2+(i3-l3)*((-2)*covi13*i1+covi11*i3+2* ...
  covi13*l1+(-1)*covi11*l3)))+(-2)*a3*aI*(covi13^2*covi22+(-2)* ...
  covi12*covi13*covi23+covi12^2*covi33+covi11*(covi23^2+(-1)* ...
  covi22*covi33))*(covi22*(i1-l1)^2+(2*covi12*(l1-i1)+ ...
  covi11*(i2-l2))*(i2-l2))*Var3+aI^2*(covi12^2+(-1)* ...
  covi11*covi22)*((-1)*covi22*(i1-l1)^2+(i2-l2)*(2* ...
  covi12*(i1-l1)+covi11*(l2-i2)))*Var3^2)));
   Grads=[(1/2)*aI^2*Var1*(a2*a3*(covi23^2*(l1-i1)+covi12*covi33* ...
  (l2-i2)+covi23*(covi13*(i2-l2)+covi12*(i3-l3))+ ...
  covi22*(covi33*i1+(-1)*covi13*i3+(-1)*covi33*l1+covi13*l3))+a3* ...
  aI*(covi33*(i1-l1)+covi13*(l3-i3))*Var2+aI*(a2*( ...
  covi22*(i1-l1)+covi12*(l2-i2))+aI*(i1-l1)*Var2)* ...
  Var3)^2*((-1)*a1*a3*(a2*(covi13^2*covi22+(-2)*covi12*covi13* ...
  covi23+covi11*covi23^2+covi12^2*covi33+(-1)*covi11*covi22*covi33) ...
  +aI*(covi13^2+(-1)*covi11*covi33)*Var2)+a1*aI*((-1)*a2* ...
  covi12^2+a2*covi11*covi22+aI*covi11*Var2)*Var3+aI*Var1*(aI* ...
  Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3*covi23^2+a3*covi22*covi33+ ...
  aI*covi22*Var3)))^(-2),(1/2)*aI^2*Var2*(a1*a3*(covi12*covi33* ...
  (l1-i1)+covi13^2*(l2-i2)+covi13*(covi23*(i1-l1)+ ...
  covi12*(i3-l3))+covi11*(covi33*i2+(-1)*covi23*i3+(-1)* ...
  covi33*l2+covi23*l3))+a3*aI*(covi33*(i2-l2)+covi23*((-1)* ...
  i3+l3))*Var1+aI*(a1*(covi12*(l1-i1)+covi11*(i2-l2))+ ...
  aI*(i2+(-1)*l2)*Var1)*Var3)^2*((-1)*a1*a3*(a2*(covi13^2* ...
  covi22+(-2)*covi12*covi13*covi23+covi11*covi23^2+covi12^2*covi33+ ...
  (-1)*covi11*covi22*covi33)+aI*(covi13^2+(-1)*covi11*covi33)* ...
  Var2)+a1*aI*((-1)*a2*covi12^2+a2*covi11*covi22+aI*covi11*Var2) ...
  *Var3+aI*Var1*(aI*Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3* ...
  covi23^2+a3*covi22*covi33+aI*covi22*Var3)))^(-2),(1/2)*aI^2*( ...
  a1*a2*(covi12*covi23*(i1-l1)+covi13*(covi22*(l1-i1)+ ...
  covi12*(i2-l2))+covi12^2*(l3-i3)+covi11*((-1)*covi23* ...
  i2+covi22*i3+covi23*l2+(-1)*covi22*l3))+a2*aI*(covi23*((-1)*i2+ ...
  l2)+covi22*(i3-l3))*Var1+aI*(a1*(covi13*(l1-i1)+ ...
  covi11*(i3-l3))+aI*(i3-l3)*Var1)*Var2)^2*Var3*((-1)* ...
  a1*a3*(a2*(covi13^2*covi22+(-2)*covi12*covi13*covi23+covi11* ...
  covi23^2+covi12^2*covi33+(-1)*covi11*covi22*covi33)+aI*( ...
  covi13^2+(-1)*covi11*covi33)*Var2)+a1*aI*((-1)*a2*covi12^2+a2* ...
  covi11*covi22+aI*covi11*Var2)*Var3+aI*Var1*(aI*Var2*(a3*covi33+ ...
  aI*Var3)+a2*((-1)*a3*covi23^2+a3*covi22*covi33+aI*covi22*Var3)) ...
  )^(-2)];
 
elseif (0 < cond110_1 && 0 < cond110_2 && 0 <= cond110_3 ) || (0 < cond111_1 && 0 < cond111_2 && 0 == cond111_3 ) 
   curr_rate=(1/2)*aI*(2*a1*a2*covi12*(l1-i1)*(i2-l2)+...
  a2*(i2-l2)^2*(a1*covi11+aI*Var1)+a1*(i1-l1)^2*(a2*covi22+aI* ...
  Var2))*(aI*Var1*(a2*covi22+aI*Var2)+a1*((-1)*a2*covi12^2+a2* ...
  covi11*covi22+aI*covi11*Var2))^(-1);
   GradI=(1/2)*(aI*Var1*(a2*covi22+aI*Var2)+a1*((-1)*a2*covi12^2+a2* ...
  covi11*covi22+aI*covi11*Var2))^(-2)*(a1^2*a2^2*(covi12^2+(-1) ...
  *covi11*covi22)*(i2-l2)*(2*covi12*(i1-l1)+covi11*(l2-i2))...
  +a2^2*aI*(i2-l2)^2*Var1*((-2)*a1*covi12^2+2* ...
  a1*covi11*covi22+aI*covi22*Var1)+2*a1*a2*aI^2*covi12*(i1-l1)...
  *(i2-l2)*Var1*Var2+a1^2*(i1-l1)^2*(a2^2* ...
  covi22*((-1)*covi12^2+covi11*covi22)+(-2)*a2*aI*(covi12^2+(-1)* ...
  covi11*covi22)*Var2+aI^2*covi11*Var2^2));
   Grads=[(1/2)*aI^2*Var1*(a2*(covi22*(i1-l1)+covi12*(l2-i2))+ ...
  aI*(i1-l1)*Var2)^2*(aI*Var1*(a2*covi22+aI*Var2)+a1*((-1) ...
  *a2*covi12^2+a2*covi11*covi22+aI*covi11*Var2))^(-2),(1/2)* ...
  aI^2*(a1*(covi12*(i1-l1)+covi11*(l2-i2))+...
  aI*(l2-i2)*Var1)^2*Var2*(aI*Var1*(a2*covi22+aI*Var2)+a1*((-1)*a2* ...
  covi12^2+a2*covi11*covi22+aI*covi11*Var2))^(-2),0];

elseif (0 < cond101_1 && 0 <= cond101_2 && 0 < cond101_3 ) || (0 < cond111_1 && 0 == cond111_2 && 0 < cond111_3 ) 
   curr_rate=(1/2)*aI*(2*a1*a3*covi13*(l1-i1)*(i3-l3)+...
  a3*(i3-l3)^2*(a1*covi11+aI*Var1)+a1*(i1-l1)^2*(a3*covi33+aI* ...
  Var3))*(aI*Var1*(a3*covi33+aI*Var3)+a1*((-1)*a3*covi13^2+a3* ...
  covi11*covi33+aI*covi11*Var3))^(-1);
   GradI=(1/2)*(aI*Var1*(a3*covi33+aI*Var3)+a1*((-1)*a3*covi13^2+a3* ...
  covi11*covi33+aI*covi11*Var3))^(-2)*(a1^2*a3^2*(covi13^2+(-1) ...
  *covi11*covi33)*(i3-l3)*(2*covi13*(i1-l1)+covi11*(l3-i3))...
  +a3^2*aI*(i3-l3)^2*Var1*((-2)*a1*covi13^2+2* ...
  a1*covi11*covi33+aI*covi33*Var1)+2*a1*a3*aI^2*covi13...
  *(i1-l1)*(i3-l3)*Var1*Var3+a1^2*(i1-l1)^2*(a3^2* ...
  covi33*((-1)*covi13^2+covi11*covi33)+(-2)*a3*aI*(covi13^2+(-1)* ...
  covi11*covi33)*Var3+aI^2*covi11*Var3^2));
   Grads=[(1/2)*aI^2*Var1*(a3*(covi33*(i1-l1)+covi13*(l3-i3))+ ...
  aI*(i1-l1)*Var3)^2*(aI*Var1*(a3*covi33+aI*Var3)+a1*((-1) ...
  *a3*covi13^2+a3*covi11*covi33+aI*covi11*Var3))^(-2),0,(1/2)* ...
  aI^2*(a1*(covi13*(i1-l1)+covi11*(l3-i3))+...
  aI*(l3-i3)*Var1)^2*Var3*(aI*Var1*(a3*covi33+aI*Var3)+a1*((-1)*a3* ...
  covi13^2+a3*covi11*covi33+aI*covi11*Var3))^(-2)];
 
elseif (0 < cond100_1 && 0 <= cond100_2 && 0 <= cond100_3 ) || (0 < cond111_1 && 0 == cond111_2 && 0 == cond111_3 ) || (0 < cond110_1 && 0 == cond110_2 && 0 <= cond110_3 ) || (0 < cond101_1 && 0 <= cond101_2 && 0 == cond101_3 ) 
   curr_rate=a1*aI*(i1-l1)^2*(2*a1*covi11+2*aI*Var1)^(-1);
   GradI=(1/2)*a1^2*covi11*(i1-l1)^2*(a1*covi11+aI*Var1)^(-2);
   Grads=[(1/2)*aI^2*(i1-l1)^2*Var1*(a1*covi11+aI*Var1)^(-2),0,0]; ...
  
elseif (0 <= cond011_1 && 0 < cond011_2 && 0 < cond011_3 ) || (0 == cond111_1 && 0 < cond111_2 && 0 < cond111_3 ) 
   curr_rate=(1/2)*aI*(2*a2*a3*covi23*(l2-i2)*(i3-l3)+...
  a3*(i3-l3)^2*(a2*covi22+aI*Var2)+a2*(i2-l2)^2*(a3*covi33+aI* ...
  Var3))*(aI*Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3*covi23^2+a3* ...
  covi22*covi33+aI*covi22*Var3))^(-1);
   GradI=(1/2)*(aI*Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3*covi23^2+a3* ...
  covi22*covi33+aI*covi22*Var3))^(-2)*(a2^2*a3^2*(covi23^2+(-1) ...
  *covi22*covi33)*(i3-l3)*(2*covi23*(i2-l2)+covi22*(l3-i3))...
  +a3^2*aI*(i3-l3)^2*Var2*((-2)*a2*covi23^2+2* ...
  a2*covi22*covi33+aI*covi33*Var2)+2*a2*a3*aI^2*covi23*(i2-l2)*...
  (i3-l3)*Var2*Var3+a2^2*(i2-l2)^2*(a3^2* ...
  covi33*((-1)*covi23^2+covi22*covi33)+(-2)*a3*aI*(covi23^2+(-1)* ...
  covi22*covi33)*Var3+aI^2*covi22*Var3^2));
   Grads=[0,(1/2)*aI^2*Var2*(a3*(covi33*(i2-l2)+covi23*(l3-i3) ...
  )+aI*(i2-l2)*Var3)^2*(aI*Var2*(a3*covi33+aI*Var3)+a2*(( ...
  -1)*a3*covi23^2+a3*covi22*covi33+aI*covi22*Var3))^(-2),(1/2)* ...
  aI^2*(a2*(covi23*(i2-l2)+covi22*(l3-i3))+...
  aI*(l3-i3)*Var2)^2*Var3*(aI*Var2*(a3*covi33+aI*Var3)+a2*((-1)*a3* ...
  covi23^2+a3*covi22*covi33+aI*covi22*Var3))^(-2)];

elseif (0 <= cond010_1 && 0 < cond010_2 && 0 <= cond010_3 ) || (0 == cond111_1 && 0 < cond111_2 && 0 == cond111_3 ) || (0 == cond110_1 && 0 < cond110_2 && 0 <= cond110_3 ) || (0 <= cond011_1 && 0 < cond011_2 && 0 == cond011_3 ) 
   curr_rate=a2*aI*(i2-l2)^2*(2*a2*covi22+2*aI*Var2)^(-1);
   GradI=(1/2)*a2^2*covi22*(i2-l2)^2*(a2*covi22+aI*Var2)^(-2);
   Grads=[0,(1/2)*aI^2*(i2-l2)^2*Var2*(a2*covi22+aI*Var2)^(-2),0]; 
  
elseif (0 <= cond001_1 && 0 <= cond001_2 && 0 < cond001_3 ) || (0 == cond111_1 && 0 == cond111_2 && 0 < cond111_3 ) || (0 == cond101_1 && 0 <= cond101_2 && 0 < cond101_3 ) || (0 <= cond011_1 && 0 == cond011_2 && 0 < cond011_3 ) 
   curr_rate=a3*aI*(i3-l3)^2*(2*a3*covi33+2*aI*Var3)^(-1);
   GradI=(1/2)*a3^2*covi33*(i3-l3)^2*(a3*covi33+aI*Var3)^(-2);
   Grads=[0,0,(1/2)*aI^2*(i3-l3)^2*Var3*(a3*covi33+aI*Var3)^(-2)]; 

else
%    	fprintf('Calling QuadProg (MCI - 3) \n');
   	[curr_rate,Grads]=qpMCI(aI,Iobj,Isig,alphs,Lobjs,Lsigs);
   	GradI=Grads(1);
   	Grads(1)=[];
end
 
% if curr_rate==Inf
%    	fprintf('Infinite MCI Looping \n');
%    	pause;
% end
 
