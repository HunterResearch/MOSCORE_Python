function [curr_rate,GradI,GradJ]=MCE2d(aI,aJ,Iobj,Isig,Jobj,Jsig)
 
i1=Iobj(1);
i2=Iobj(2);
j1=Jobj(1);
j2=Jobj(2);
covj11=Jsig(1,1);
covj12=Jsig(1,2);
covj22=Jsig(2,2);
covi11=Isig(1,1);
covi12=Isig(1,2);
covi22=Isig(2,2);
 
cond11_1=aI*aJ*(aJ^2*((-1)*covi12^2+covi11*covi22)+aI*aJ*(covi22* ...
  covj11+(-2)*covi12*covj12+covi11*covj22)+aI^2*((-1)*covj12^2+ ...
  covj11*covj22))^(-1)*((aJ*covi22+aI*covj22)*(j1-i1)+(aJ* ...
  covi12+aI*covj12)*(i2-j2));
cond11_2=aI*aJ*(aJ^2*((-1)*covi12^2+covi11*covi22)+aI*aJ*(covi22* ...
  covj11+(-2)*covi12*covj12+covi11*covj22)+aI^2*((-1)*covj12^2+ ...
  covj11*covj22))^(-1)*((aJ*covi12+aI*covj12)*(i1-j1)+(aJ* ...
  covi11+aI*covj11)*(j2-i2));
cond10_1=aI*aJ*(aJ*covi11+aI*covj11)^(-1)*(j1-i1);
cond10_2=i2-j2+(aJ*covi11+aI*covj11)^(-1)*(aJ*covi12+aI*covj12)*(j1-i1);
cond01_1=i1-j1+(aJ*covi12+aI*covj12)*(aJ*covi22+aI*covj22)^(-1)*(j2-i2);
cond01_2=aI*aJ*(aJ*covi22+aI*covj22)^(-1)*(j2-i2);
 
 
if (0 < cond11_1 && 0 < cond11_2 ) 
   curr_rate=(1/2)*aI*aJ*(aJ^2*((-1)*covi12^2+covi11*covi22)+aI*aJ*( ...
  covi22*covj11+(-2)*covi12*covj12+covi11*covj22)+aI^2*((-1)* ...
  covj12^2+covj11*covj22))^(-1)*((aJ*covi22+aI*covj22)*(i1-j1)^2+...
  2*(aJ*covi12+aI*covj12)*(j1-i1)*(i2-j2)+(aJ*covi11+aI*covj11)*(i2-j2)^2);
   GradI=(1/2)*aJ^2*(aJ^2*(covi12^2+(-1)*covi11*covi22)+(-1)*aI*aJ*( ...
  covi22*covj11+(-2)*covi12*covj12+covi11*covj22)+aI^2*(covj12^2+( ...
  -1)*covj11*covj22))^(-2)*(aJ^2*(covi12^2+(-1)*covi11*covi22)*( ...
  (-1)*covi22*(i1-j1)^2+(i2-j2)*(2*covi12*i1+(-1)* ...
  covi11*i2+(-2)*covi12*j1+covi11*j2))+(-2)*aI*aJ*(covi12^2+(-1)* ...
  covi11*covi22)*(covj22*(i1-j1)^2+(i2-j2)*((-2)* ...
  covj12*i1+covj11*i2+2*covj12*j1+(-1)*covj11*j2))+aI^2*(covi22*( ...
  covj12*(i1-j1)+covj11*(j2-i2))^2+(covj22*(i1-j1)+ ...
  covj12*(j2-i2))*(2*covi12*((-1)*covj12*i1+covj11*i2+ ...
  covj12*j1+(-1)*covj11*j2)+covi11*(covj22*i1+(-1)*covj12*i2+(-1)* ...
  covj22*j1+covj12*j2))));
   GradJ=(1/2)*aI^2*(aJ^2*(covi12^2+(-1)*covi11*covi22)+(-1)*aI*aJ*( ...
  covi22*covj11+(-2)*covi12*covj12+covi11*covj22)+aI^2*(covj12^2+( ...
  -1)*covj11*covj22))^(-2)*((-2)*aI*aJ*(covj12^2+(-1)*covj11* ...
  covj22)*(covi22*(i1-j1)^2+(2*covi12*(j1-i1)+covi11*( ...
  i2-j2))*(i2-j2))+aI^2*(covj12^2+(-1)*covj11*covj22)*( ...
  (-1)*covj22*(i1-j1)^2+(i2-j2)*(2*covj12*(i1-j1)+ ...
  covj11*(j2-i2)))+aJ^2*(covi22^2*covj11*(i1-j1)^2+(-2) ...
  *covi11*covi12*(covj22*(i1-j1)+covj12*(i2-j2))*(i2-j2)+...
  covi11^2*covj22*(i2-j2)^2+covi12^2*(covj22*(i1-j1)^2+...
  (i2-j2)*(2*covj12*i1+covj11*i2+(-2)*covj12*j1+( ...
  -1)*covj11*j2))+(-2)*covi22*(i1-j1)*(covi11*covj12*(j2-i2)+...
  covi12*(covj12*i1+covj11*i2+(-1)*covj12*j1+(-1)*covj11*j2))));

elseif (0 < cond10_1 && 0 <= cond10_2 ) || (0 < cond11_1 && 0 == cond11_2 ) 
   curr_rate=aI*aJ*(2*aJ*covi11+2*aI*covj11)^(-1)*(i1-j1)^2;
   GradI=(1/2)*aJ^2*covi11*(aJ*covi11+aI*covj11)^(-2)*(i1-j1)^2;
   GradJ=(1/2)*aI^2*covj11*(aJ*covi11+aI*covj11)^(-2)*(i1-j1)^2;

elseif (0 <= cond01_1 && 0 < cond01_2 ) || (0 == cond11_1 && 0 < cond11_2 ) 
   curr_rate=aI*aJ*(2*aJ*covi22+2*aI*covj22)^(-1)*(i2-j2)^2;
   GradI=(1/2)*aJ^2*covi22*(aJ*covi22+aI*covj22)^(-2)*(i2-j2)^2;
   GradJ=(1/2)*aI^2*covj22*(aJ*covi22+aI*covj22)^(-2)*(i2-j2)^2;

else
   	fprintf('Calling QuadProg (MCE - 2) \n');
   	[curr_rate,GradI,GradJ]=qpMCE(aI,aJ,Iobj,Isig,Jobj,Jsig);
end
 
% if curr_rate==Inf
%    	fprintf('Infinite MCE Looping \n');
%    	pause;
% end
 
